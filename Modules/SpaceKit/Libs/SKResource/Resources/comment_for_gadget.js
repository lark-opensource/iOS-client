!function(){"use strict";const e="object"==typeof globalThis&&globalThis||"object"==typeof window&&window||"object"==typeof self&&self||"object"==typeof global&&global||Function("return this")();var t,n;(n=t||(t={})).success="success",n.failure="failure",n.timeout="timeout",n.cancel="cancel";let i=0;var o,s,r,a=new class{constructor(){this.events={},this.initNativeCallBack()}initNativeCallBack(){var t;if(null==(t=e.LarkWebViewJavaScriptBridge)?void 0:t.nativeCallBack){const t=e.LarkWebViewJavaScriptBridge.nativeCallBack;e.LarkWebViewJavaScriptBridge={nativeCallBack:e=>{t(e),this.nativeCallBack(e)}}}else e.LarkWebViewJavaScriptBridge={nativeCallBack:this.nativeCallBack.bind(this)}}callSync(e,t){const n={callbackID:this.genCallbackID(e),apiName:e,data:t};return this.sendMessageToNative(n)}call(e,t){return new Promise(((n,i)=>{const o=this.genCallbackID(e),s=e=>{this.off(o,s),"__bridgeError__"in e?i(e):n(e)};this.events[o]={apiName:e,fns:[s]};const r={callbackID:o,apiName:e,data:t};this.sendMessageToNative(r),setTimeout((()=>{this.off(o,s),i(new Error("timeout"))}),6e4)}))}on(e,t){let n=Object.keys(this.events).find((t=>this.events[t].apiName===e));if(n){this.events[n].fns.push(t)}else{n=this.genCallbackID(e),this.events[n]={apiName:e,fns:[t]};const i={callbackID:n,apiName:e};this.sendMessageToNative(i)}return()=>{this.off(n,t)}}off(e,t){const n=this.events[e];n&&(n.fns=n.fns.filter((e=>e!==t)),0===n.fns.length&&delete this.events[e])}nativeCallBack(e){var n;let{callbackID:i,data:o,callbackType:s}=e;if("string"==typeof o)try{o=JSON.parse(o)}catch(e){}const r=null==(n=this.events[i])?void 0:n.fns;if(!r)throw new Error(`[Bridge] missing handler for callbackId ${i}`);r.forEach((e=>{Promise.resolve().then((()=>{if(s===t.success)e(o);else{const t=new Error("[Bridge] callback error.");t.__bridgeError__=!0,t.data=o,t.type=s,e(t)}}))}))}sendMessageToNative(e){switch(this.getSystemType()){case"ios":return webkit.messageHandlers.invokeNative.postMessage(e);case"android":return Lark_Bridge.invokeNative(JSON.stringify(e));default:throw new Error("type is not matched")}}getSystemType(){return e.webkit?"ios":e.Lark_Bridge?"android":new Error("get system error")}genCallbackID(e){return`callback_${e.replace(/\./g,"_")}_${++i}`}};{let e=function(e,...n){a.call("biz.util.logger",{logMessage:t(e,...n)})},t=function(e,...t){const n=new Date;return`[${e}] ${`${n.getUTCFullYear()}-${n.getUTCMonth()+1}-${n.getUTCDate()} ${n.getUTCHours()}:${n.getUTCMinutes()}:${n.getUTCSeconds()}`} [COMMENT_WORKER]${t.length>0?" "+t.join(""):""}`};const n=console.log.bind(console);console.log=function(...t){n(...t),e("log",...t)};const i=console.info.bind(console);console.info=function(...t){i(...t),e("info",...t)};const o=console.warn.bind(console);console.warn=function(...t){o(...t),e("warn",...t)};const s=console.error.bind(console);console.error=function(...t){s(...t),e("error",...t)}}!function(e){e[e.trace=1]="trace",e[e.normal=2]="normal",e[e.warn=3]="warn",e[e.error=4]="error",e[e.fatal=5]="fatal"}(o||(o={})),function(e){e.traceId="trace_id",e.errorCode="error_code",e.errorMsg="error_msg",e.time="time",e.duration="duration",e.monitorLevel="monitor_level",e.monitorDomain="monitor_domain",e.monitorCode="monitor_code",e.monitorID="monitor_id",e.monitorMessage="monitor_message",e.monitorTags="monitor_tags",e.monitorFile="monitor_file",e.monitorFunction="monitor_function",e.monitorLine="monitor_line",e.monitorColumn="monitor_column",e.monitorStack="monitor_stack",e.resultType="result_type"}(s||(s={})),function(e){e.BATCH="BATCH"}(r||(r={}));var c,l,d,m;!function(e){e.success="success",e.fail="fail",e.cancel="cancel",e.timeout="timeout"}(c||(c={})),function(e){e[e.debug=1]="debug",e[e.info=2]="info",e[e.warn=3]="warn",e[e.error=4]="error",e[e.fatal=5]="fatal"}(l||(l={})),function(e){e.warn="warn",e.error="error"}(d||(d={})),function(e){e.sampleRate="sample_rate",e.traceSampleRate="trace_sample_rate",e.normalSampleRate="normal_sample_rate",e.warnSampleRate="warn_sample_rate",e.errorSampleRate="error_sample_rate",e.fatalSampleRate="fatal_sample_rate",e.rules="rules",e.priority="priority",e.filters="filters",e.key="key",e.values="values"}(m||(m={}));const h={logEnabled:!1,reportEnabled:!1,batchBlackListEnabled:!1,batchWhiteListEnabled:!1,batchBlackList:[],batchWhiteList:[],bizBlackList:[]};class p{constructor(e){this.hitBlackList=!1,this.hitWhiteList=!1,this._batchEnabled=!1,this._createTime=Date.now(),this.generateTraceId(e),this.batchReportEnabled=this.constructor.config.reportEnabled||!1,this.batchLogEnabled=this.constructor.config.logEnabled||!1}static setConfig(e){this.config=e}static resetConfig(){this.config=Object.assign({},h)}get blackListEnabled(){return this.constructor.config.batchBlackListEnabled||h.batchBlackListEnabled}get whiteListEnabled(){return this.constructor.config.batchWhiteListEnabled||h.batchWhiteListEnabled}get batchEnabled(){return this._batchEnabled}get traceId(){return this._traceId}set traceId(e){this._traceId=e}get createTime(){return this._createTime}generateSpan(){return new p(this)}reportTo(e){const{batchBlackListEnabled:t=h.batchBlackListEnabled,batchWhiteListEnabled:n=h.batchWhiteListEnabled,batchBlackList:i=h.batchBlackList,batchWhiteList:o=h.batchWhiteList}=this.constructor.config;return!this.hitBlackList&&t&&i.some((t=>this.matchRule(t,e)))&&(this.hitBlackList=!0),!this.hitBlackList&&!this.hitWhiteList&&this.batchReportEnabled&&n&&o.some((t=>this.matchRule(t,e)))&&(this.hitWhiteList=!0),this._monitorCache||(this._monitorCache=[]),!this.hitBlackList&&this._monitorCache.push(JSON.stringify(e)),this}finish(){const{batchLogEnabled:e,batchReportEnabled:t}=this;let n=t;return n&&(this.blackListEnabled&&this.hitBlackList||this.whiteListEnabled&&!this.hitWhiteList)&&(n=!1),{name:"monitor_batch_report",code:{domain:"monitor.base.batch",code:1e4,level:2,message:"monitor_batch_code"},categories:{batch:JSON.stringify(this._monitorCache),[s.traceId]:this._traceId},internalData:{logEnabled:this.batchEnabled&&e,reportEnabled:this.batchEnabled&&n}}}parse(e){return"extensions"in e&&!("trace"in e)?(this._createTime=e.createTime,this._traceId=e.traceId):(this._createTime=e.trace.createTime,this._traceId=e.trace.traceId,this._batchEnabled=e.batchEnabled,e.monitorCache&&(this._monitorCache=[...e.monitorCache])),this}toJSON(){const e={trace:{createTime:this._createTime,traceId:this._traceId},batchEnabled:this._batchEnabled};return this._monitorCache&&(e.monitorCache=[...this._monitorCache]),e}serialize(){return JSON.stringify(this)}deserialize(e){const t=JSON.parse(e);return this.parse(t)}checkBatchEnabled(e){const t=this.constructor.config.bizBlackList;return!t||!t.includes(e)}subTrace(e){const t=new this.constructor(this);return e?this.checkBatchEnabled(e)?(t._batchEnabled=!0,t):(t._batchEnabled=this._batchEnabled,t):(t._batchEnabled=this.batchEnabled,t)}getTraceId(){return this._traceId}generateTraceId(e){let t;t=e?e.getTraceId():"1",this._traceId=function(e){return e?`${e}-${[...Array(8)].map((()=>Math.floor(36*Math.random()).toString(36))).join("")}`:""}(t)}matchRule(e,t){const n=t.getName(),i=t.getMonitorId(),o=t.getMonitorDomain(),{event_name:s=[],monitor_id:r=[],monitor_domain:a=[],monitor_domain_prefix:c=[]}=e;return!(!n||!s.some((e=>e===n)))||(!(!i||!r.some((e=>e===i)))||!(!o||!a.some((e=>e===o))&&!c.some((e=>o.startsWith(e)))))}}p.config=h;let u=[];const g={addTraceId(e){if(!e)return;const t=new p;t.traceId=e,u.push({traceId:e,trace:t})},removeByTraceId(e){e&&(u=u.filter((t=>t.traceId===e)))}};if("undefined"!=typeof webkit){const e=webkit.messageHandlers.invokeNative.postMessage;webkit.messageHandlers.invokeNative.postMessage=function(t){u.length>0&&(t.extra={api_trace:u[u.length-1].trace.subTrace().traceId}),e(t)}}if("undefined"!=typeof Lark_Bridge){const e=Lark_Bridge.invokeNative;Lark_Bridge.invokeNative=function(t){u.length>0&&((t=JSON.parse(t)).extra={api_trace:u[u.length-1].trace.subTrace().traceId},t=JSON.stringify(t)),e(t)}}const f={of:e=>["log","info","warn","error","trace"].reduce(((t,n)=>(t[n]=function(...t){console[n](function(e){const t=new Date;return`${t.getUTCFullYear()}-${t.getUTCMonth()+1}-${t.getUTCDate()} ${t.getUTCHours()}:${t.getUTCMinutes()}:${t.getUTCSeconds()} [${e||"default"}] `}(e),...t)},t)),{})};"undefined"!=typeof require&&require;class v{constructor(){this.events=new Map,this.cache=new Map}on(e,t,n={}){var i;const{once:o=!1,context:s=null,emitLatestEvent:r=!1}=n,a=null!=(i=this.events.get(e))?i:[];for(const e of a)if(e.fn===t)return this;const c={fn:t,once:o,context:s};return this.events.has(e)?this.events.get(e).push(c):this.events.set(e,[c]),r&&this.cache.has(e)&&t.call(s,...this.cache.get(e)),this}off(e,t){if(!this.events.has(e))return this;if(!t)return this.events.delete(e),this;const n=this.events.get(e).filter((e=>e.fn!==t));return 0===n.length?this.events.delete(e):this.events.set(e,n),this}emit(e,...t){return n=this,i=null,o=function*(){if(this.cache.set(e,t),!this.events.has(e))return[];const n=this.events.get(e);return Promise.all([...n].map((n=>{const{fn:i,context:o,once:s}=n;return s&&this.off(e,i),i.call(o,...t)})))},new Promise(((e,t)=>{var s=e=>{try{a(o.next(e))}catch(e){t(e)}},r=e=>{try{a(o.throw(e))}catch(e){t(e)}},a=t=>t.done?e(t.value):Promise.resolve(t.value).then(s,r);a((o=o.apply(n,i)).next())}));var n,i,o}clear(){this.events.clear(),this.cache.clear()}}function y(e,t){const n=Object.keys(e).find((e=>e.toLowerCase()===t.toLowerCase()));return n&&e[n]}function _(e){return e&&e.toString&&"function"==typeof e.toString?e.toString().replace(/(doc|sht|bmn|wik|dox|box|bas|sld|fld)(\w{1})(\w){1}([\d\w]{3})([\d\w]{11,16})([\d\w]{3})/g,"$1$2*$4***$6"):"null"}var b="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function k(e){var t={exports:{}};return e(t,t.exports),t.exports}var w=k((function(e){!function(t){function n(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function i(e,t,i,o,s,r){return n((a=n(n(t,e),n(o,r)))<<(c=s)|a>>>32-c,i);var a,c}function o(e,t,n,o,s,r,a){return i(t&n|~t&o,e,t,s,r,a)}function s(e,t,n,o,s,r,a){return i(t&o|n&~o,e,t,s,r,a)}function r(e,t,n,o,s,r,a){return i(t^n^o,e,t,s,r,a)}function a(e,t,n,o,s,r,a){return i(n^(t|~o),e,t,s,r,a)}function c(e,t){var i,c,l,d,m;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var h=1732584193,p=-271733879,u=-1732584194,g=271733878;for(i=0;i<e.length;i+=16)c=h,l=p,d=u,m=g,h=o(h,p,u,g,e[i],7,-680876936),g=o(g,h,p,u,e[i+1],12,-389564586),u=o(u,g,h,p,e[i+2],17,606105819),p=o(p,u,g,h,e[i+3],22,-1044525330),h=o(h,p,u,g,e[i+4],7,-176418897),g=o(g,h,p,u,e[i+5],12,1200080426),u=o(u,g,h,p,e[i+6],17,-1473231341),p=o(p,u,g,h,e[i+7],22,-45705983),h=o(h,p,u,g,e[i+8],7,1770035416),g=o(g,h,p,u,e[i+9],12,-1958414417),u=o(u,g,h,p,e[i+10],17,-42063),p=o(p,u,g,h,e[i+11],22,-1990404162),h=o(h,p,u,g,e[i+12],7,1804603682),g=o(g,h,p,u,e[i+13],12,-40341101),u=o(u,g,h,p,e[i+14],17,-1502002290),h=s(h,p=o(p,u,g,h,e[i+15],22,1236535329),u,g,e[i+1],5,-165796510),g=s(g,h,p,u,e[i+6],9,-1069501632),u=s(u,g,h,p,e[i+11],14,643717713),p=s(p,u,g,h,e[i],20,-373897302),h=s(h,p,u,g,e[i+5],5,-701558691),g=s(g,h,p,u,e[i+10],9,38016083),u=s(u,g,h,p,e[i+15],14,-660478335),p=s(p,u,g,h,e[i+4],20,-405537848),h=s(h,p,u,g,e[i+9],5,568446438),g=s(g,h,p,u,e[i+14],9,-1019803690),u=s(u,g,h,p,e[i+3],14,-187363961),p=s(p,u,g,h,e[i+8],20,1163531501),h=s(h,p,u,g,e[i+13],5,-1444681467),g=s(g,h,p,u,e[i+2],9,-51403784),u=s(u,g,h,p,e[i+7],14,1735328473),h=r(h,p=s(p,u,g,h,e[i+12],20,-1926607734),u,g,e[i+5],4,-378558),g=r(g,h,p,u,e[i+8],11,-2022574463),u=r(u,g,h,p,e[i+11],16,1839030562),p=r(p,u,g,h,e[i+14],23,-35309556),h=r(h,p,u,g,e[i+1],4,-1530992060),g=r(g,h,p,u,e[i+4],11,1272893353),u=r(u,g,h,p,e[i+7],16,-155497632),p=r(p,u,g,h,e[i+10],23,-1094730640),h=r(h,p,u,g,e[i+13],4,681279174),g=r(g,h,p,u,e[i],11,-358537222),u=r(u,g,h,p,e[i+3],16,-722521979),p=r(p,u,g,h,e[i+6],23,76029189),h=r(h,p,u,g,e[i+9],4,-640364487),g=r(g,h,p,u,e[i+12],11,-421815835),u=r(u,g,h,p,e[i+15],16,530742520),h=a(h,p=r(p,u,g,h,e[i+2],23,-995338651),u,g,e[i],6,-198630844),g=a(g,h,p,u,e[i+7],10,1126891415),u=a(u,g,h,p,e[i+14],15,-1416354905),p=a(p,u,g,h,e[i+5],21,-57434055),h=a(h,p,u,g,e[i+12],6,1700485571),g=a(g,h,p,u,e[i+3],10,-1894986606),u=a(u,g,h,p,e[i+10],15,-1051523),p=a(p,u,g,h,e[i+1],21,-2054922799),h=a(h,p,u,g,e[i+8],6,1873313359),g=a(g,h,p,u,e[i+15],10,-30611744),u=a(u,g,h,p,e[i+6],15,-1560198380),p=a(p,u,g,h,e[i+13],21,1309151649),h=a(h,p,u,g,e[i+4],6,-145523070),g=a(g,h,p,u,e[i+11],10,-1120210379),u=a(u,g,h,p,e[i+2],15,718787259),p=a(p,u,g,h,e[i+9],21,-343485551),h=n(h,c),p=n(p,l),u=n(u,d),g=n(g,m);return[h,p,u,g]}function l(e){var t,n="",i=32*e.length;for(t=0;t<i;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function d(e){var t,n=[];for(n[(e.length>>2)-1]=void 0,t=0;t<n.length;t+=1)n[t]=0;var i=8*e.length;for(t=0;t<i;t+=8)n[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return n}function m(e){var t,n,i="0123456789abcdef",o="";for(n=0;n<e.length;n+=1)t=e.charCodeAt(n),o+=i.charAt(t>>>4&15)+i.charAt(15&t);return o}function h(e){return unescape(encodeURIComponent(e))}function p(e){return function(e){return l(c(d(e),8*e.length))}(h(e))}function u(e,t){return function(e,t){var n,i,o=d(e),s=[],r=[];for(s[15]=r[15]=void 0,o.length>16&&(o=c(o,8*e.length)),n=0;n<16;n+=1)s[n]=909522486^o[n],r[n]=1549556828^o[n];return i=c(s.concat(d(t)),512+8*t.length),l(c(r.concat(i),640))}(h(e),h(t))}function g(e,t,n){return t?n?u(t,e):function(e,t){return m(u(e,t))}(t,e):n?p(e):m(p(e))}e.exports?e.exports=g:t.md5=g}(b)})),C=k((function(e,t){var n;e.exports=n=n||function(e,t){var n=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),i={},o=i.lib={},s=o.Base={extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},r=o.WordArray=s.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=n!=t?n:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,n=e.words,i=this.sigBytes,o=e.sigBytes;if(this.clamp(),i%4)for(var s=0;s<o;s++){var r=n[s>>>2]>>>24-s%4*8&255;t[i+s>>>2]|=r<<24-(i+s)%4*8}else for(s=0;s<o;s+=4)t[i+s>>>2]=n[s>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=s.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n,i=[],o=function(t){t=t;var n=987654321,i=4294967295;return function(){var o=((n=36969*(65535&n)+(n>>16)&i)<<16)+(t=18e3*(65535&t)+(t>>16)&i)&i;return o/=4294967296,(o+=.5)*(e.random()>.5?1:-1)}},s=0;s<t;s+=4){var a=o(4294967296*(n||e.random()));n=987654071*a(),i.push(4294967296*a()|0)}return new r.init(i,t)}}),a=i.enc={},c=a.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],o=0;o<n;o++){var s=t[o>>>2]>>>24-o%4*8&255;i.push((s>>>4).toString(16)),i.push((15&s).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i+=2)n[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new r.init(n,t/2)}},l=a.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],o=0;o<n;o++){var s=t[o>>>2]>>>24-o%4*8&255;i.push(String.fromCharCode(s))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i++)n[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new r.init(n,t)}},d=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},m=o.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new r.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,i=n.words,o=n.sigBytes,s=this.blockSize,a=o/(4*s),c=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*s,l=e.min(4*c,o);if(c){for(var d=0;d<c;d+=s)this._doProcessBlock(i,d);var m=i.splice(0,c);n.sigBytes-=l}return new r.init(m,l)},clone:function(){var e=s.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});o.Hasher=m.extend({cfg:s.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){m.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new h.HMAC.init(e,n).finalize(t)}}});var h=i.algo={};return i}(Math)})),I=k((function(e,t){var n,i,o,s,r,a,c,l;e.exports=(i=(n=l=C).lib,o=i.WordArray,s=i.Hasher,r=n.algo,a=[],c=r.SHA1=s.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],o=n[1],s=n[2],r=n[3],c=n[4],l=0;l<80;l++){if(l<16)a[l]=0|e[t+l];else{var d=a[l-3]^a[l-8]^a[l-14]^a[l-16];a[l]=d<<1|d>>>31}var m=(i<<5|i>>>27)+c+a[l];m+=l<20?1518500249+(o&s|~o&r):l<40?1859775393+(o^s^r):l<60?(o&s|o&r|s&r)-1894007588:(o^s^r)-899497514,c=r,r=s,s=o<<30|o>>>2,o=i,i=m}n[0]=n[0]+i|0,n[1]=n[1]+o|0,n[2]=n[2]+s|0,n[3]=n[3]+r|0,n[4]=n[4]+c|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[14+(i+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(i+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}}),n.SHA1=s._createHelper(c),n.HmacSHA1=s._createHmacHelper(c),l.SHA1)}));const E=function(e){const t=String(e);return I(`08a441${w(t+"42b91e")}`).toString()},P="https?|s?ftp|ftps|nfs|ssh",S="\\b([/?#][-a-zA-Z0-9@:%_+.~#?&/=;$,!\\*\\[\\]{}^|<>]*)?",M=new RegExp(`((((${P})://)?(${/localhost(:[0-9]{2,5})?/.source}))|(((${P})://)(${/(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}(2[0-4][0-9]|25[0-5]|1[0-9]{2}|[1-9][0-9]|[0-9])(:[0-9]{2,5})?/.source})))${S}`,"gi"),T="([\\-a-zA-Z0-9:%_+~#@]{1,256}\\.){1,50}",R=new RegExp(`(((${P}):\\/\\/${T}[a-z\\-]{2,15})|(${T}(com|cn|tk|de|net|org|uk|info|nl|ru)))(:[0-9]{2,5})?${S}`,"gi"),O="[\\w.!#$%&'*+-/=?^_\\`{|}~]{1,2000}@[A-Za-z0-9_.-]+\\.",L=new RegExp(`^(?!data:)((mailto:${O}[a-z\\-]{2,15})|(${O}(com|org|net|int|edu|gov|mil|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gh|gi|gl|gm|gn|gp|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mf|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|site|top|wtf|xxx|xyz|cloud|engineering|help|one)))\\b`,"gi");function x(e){var t,n,i;if(e.isInteractionServerBizError)return{msg:`server biz error, api: ${e.api}, code ${e.code}, logId: ${e.logId}`,api:e.api,status:200,code:e.code,logId:e.logId};if(e.response){const i=y(e.response.headers||{},"x-tt-logid"),o=e.response.status,s=null==(n=null==(t=e.response)?void 0:t.config.url)?void 0:n.replace(e.response.config.baseURL||"","");return{msg:`gateway error, api: ${s}, status: ${o}, logId: ${i}`,api:s,status:o,logId:i}}if(e.config){const t=null==(i=e.config.url)?void 0:i.replace(e.config.baseURL||"",""),n=y(e.config.headers||{},"x-tt-logid");return{msg:`network error, api: ${t}, logId: ${n}`,api:t,logId:n}}return{msg:e.message}}new RegExp(`(${M.source})|(${R.source})|(${L.source})`,"gi");const H={of:e=>function(t){return function(n,i,o){const{value:s}=o;if(!s||"function"!=typeof s)throw new Error("monitor dev event can only used for func");o.value=function(...n){const o=(n,i)=>{this.reportTea("mobile_interaction_dev",{appId:this.entity.appId,uniqueId:E(this.entity.token),timestamp:Date.now(),context:e,exec_stage:(null==t?void 0:t.execStage)||"api_call",exec_type:i,msg:n,obj_type:this.entity.type})};try{let e="";(null==t?void 0:t.customMessage)?(e=Function.prototype.apply.call(t.customMessage,this,n),e&&_(e)):e=`api ${i} called`,e&&o(e,"NORMAL");const a=Function.prototype.apply.call(s,this,n);return!(r=a)||"object"!=typeof r&&"function"!=typeof r||"function"!=typeof r.then?a:a.catch((e=>{const t=`api ${i} call has error: ${_(x(e).msg)}`;throw o(t,"EXCEPTION"),e}))}catch(e){const t=`api ${i} call has error: ${_(x(e).msg)}`;throw o(t,"EXCEPTION"),e}var r}}}};var $=Object.defineProperty,N=Object.getOwnPropertySymbols,D=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable,A=(e,t,n)=>t in e?$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,U=(e,t)=>{for(var n in t||(t={}))D.call(t,n)&&A(e,n,t[n]);if(N)for(var n of N(t))B.call(t,n)&&A(e,n,t[n]);return e};"undefined"!=typeof require&&require;var z=new class{constructor(){this.callbackPool=new Map,this.services=new Map,this.logger=f.of("WORK_BRIDGE"),worker.onMessage(this.handleMessage.bind(this))}register(e,t){this.services.set(e,{service:e,func:t})}call({header:e,body:t}){return new Promise(((n,i)=>{const o=Date.now()+String(j++);this.callbackPool.set(o,{service:e.service,func:(e,t)=>(this.callbackPool.delete(o),e?i(e):n(t))});const s=`request service: ${e.service}, callbackId: ${o}`;this.logger.log(s),q({exec_stage:"request",exec_type:"NORMAL",msg:s}),worker.postMessage({type:"request",header:U({callbackId:o},e),body:t})}))}handleMessage(e){if("request"===e.type)return this.handleRequestMessage(e);if("response"===e.type)return this.handleResponseMessage(e);throw new Error("unknown message type")}handleRequestMessage(e){return t=this,n=null,i=function*(){const{header:t,body:n}=e,{callbackId:i,service:o,token:s,traceId:r}=t;g.addTraceId(r);const a=`receive request, service: ${o}, callbackId: ${i}`;if(q({exec_stage:"receive_request",exec_type:"NORMAL",msg:a}),this.logger.log(a),!this.services.has(o)){const e=`service: ${o} not found`;return worker.postMessage({type:"response",header:{callbackId:i,token:s,traceId:r,service:o,code:1,errorMsg:`service: ${o} not found`}}),this.logger.log(e),q({exec_stage:"send_response",exec_type:"EXCEPTION",msg:e}),g.removeByTraceId(r)}const{func:c}=this.services.get(o),l={type:"response",header:{callbackId:i,traceId:r,token:s,service:o,code:0}};try{l.body=yield Promise.resolve(c({token:s,body:n}))}catch(e){const t=`service ${o} call error: ${e.message}`;this.logger.log(t),q({exec_stage:"send_response",exec_type:"EXCEPTION",msg:t}),l.header.code=1,l.header.errorMsg=e.message,e.isRNError&&(l.header.code=e.code,l.header.logId=e.logId)}finally{const e=`send response for ${o}, callbackId: ${i}`;this.logger.log(e),q({exec_stage:"send_response",exec_type:"NORMAL",msg:e}),worker.postMessage(l),g.removeByTraceId(r)}},new Promise(((e,o)=>{var s=e=>{try{a(i.next(e))}catch(e){o(e)}},r=e=>{try{a(i.throw(e))}catch(e){o(e)}},a=t=>t.done?e(t.value):Promise.resolve(t.value).then(s,r);a((i=i.apply(t,n)).next())}));var t,n,i}handleResponseMessage(e){const{header:t,body:n}=e,{callbackId:i,code:o,errorMsg:s}=t;if(q({exec_stage:"receive_response",exec_type:0===o?"NORMAL":"EXCEPTION",msg:`receive response, callbackId: ${i}, code: ${o}, errorMsg: ${s}`}),!this.callbackPool.has(i)){const e=`callbackId: ${i} not found`;this.logger.error(e),q({exec_stage:"response",exec_type:"EXCEPTION",msg:e})}const{func:r}=this.callbackPool.get(i);r(0===o?n:new Error(s))}};let j=0;function q(e){a.call("biz.statistics.reportEvent",{event_name:"mobile_interaction_dev",data:U({appId:"gadget_common",uniqueId:"gadget_common",context:"GADGET_WORKER",timestamp:Date.now()},e),noPrefix:!0})}class W extends Error{constructor(e,t){super(e),this.data=t}}class V extends W{constructor(e){super("canceled",e),this.canceled=!0}}class F{reportTea(e,t){a.call("biz.statistics.reportEvent",{event_name:e,data:t,noPrefix:!0})}}var J=Object.defineProperty,G=Object.getOwnPropertyDescriptor,K=Object.getOwnPropertySymbols,Y=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable,Z=(e,t,n)=>t in e?J(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Q=(e,t)=>{for(var n in t||(t={}))Y.call(t,n)&&Z(e,n,t[n]);if(K)for(var n of K(t))X.call(t,n)&&Z(e,n,t[n]);return e};"undefined"!=typeof require&&require;var ee,te,ne=(e,t,n,i)=>{for(var o,s=i>1?void 0:i?G(t,n):t,r=e.length-1;r>=0;r--)(o=e[r])&&(s=(i?o(t,n,s):o(s))||s);return i&&s&&J(t,n,s),s};(te=ee||(ee={}))[te.SUCCESS=0]="SUCCESS",te[te.FAIL=1]="FAIL";const ie="RN_CLIENT",oe=H.of(ie),se=new Map,re=new Map;let ae;class ce{constructor(){this.logger=f.of(ie),this.processMessage=this.processMessage.bind(this)}reportTea(e,t){this.logger.info(t.msg||t.exec_stage),(new F).reportTea(e,t)}postMessage(e){const{service:t,body:n,timeout:i=6e4}=e;let o;return new Promise(((s,r)=>{var c;let l;i&&(l=setTimeout((()=>{r(new Error(`service ${t} timeout`))}),i));o=`${t}_${Date.now()}_${de++}`,se.set(o,(function(e,t){return l&&clearTimeout(l),e?r(e):s(t)}));const d={operation:"comment",type:"request",headers:Q({service:t,from:"rn_client",requestId:o},null!=(c=e.headers)?c:{}),body:n};a.call("biz.comment.postMessage",d)})).finally((()=>{se.delete(o)}))}registerService(e,t){re.set(e,t)}removeService(e){re.delete(e)}init(e){this.entity=e,null==ae||ae(),ae=a.on("biz.comment.onMessage",this.processMessage)}destroy(){null==ae||ae()}processMessage(e){if("__bridgeError__"in e)return;const{requestId:t,service:n}=e.headers;if("response"===e.type){const n=se.get(t);if(!n)throw new Error(`can not find corresponding callback for requestId: ${t}`);return 0===e.headers.code?n(null,e.body):n(new me(e.headers.msg||"call rn error",e.headers.code,e.headers.logId))}if("request"===e.type){const{body:i}=e,o=re.get(n),s={operation:"comment",type:"response",headers:{requestId:t,service:n,from:"rn_client",code:0},body:void 0};return o?void Promise.resolve(o(i)).then((e=>{s.body=e})).catch((e=>{s.headers.code=1,s.headers.msg=e.message})).finally((()=>{a.call("biz.comment.postMessage",s)})):(s.headers.code=1,s.headers.msg=`missing service: ${n}`,void a.call("biz.comment.postMessage",s))}}}ne([oe({customMessage:e=>`post message to rn, service ${e.service}`})],ce.prototype,"postMessage",1),ne([oe()],ce.prototype,"registerService",1),ne([oe()],ce.prototype,"removeService",1),ne([oe()],ce.prototype,"destroy",1),ne([oe({customMessage(e){if("response"===e.type){const{service:t,code:n}=e.headers;return`receive response service: ${t}, code: ${n}`}if("request"===e.type){const{service:t}=e.headers;return`receive request service: ${t}`}return""}})],ce.prototype,"processMessage",1);const le=new ce;let de=1;class me extends Error{constructor(e,t,n){super(e),this.isRNError=!0,this.code=t,this.logId=n}}var he=Object.defineProperty,pe=Object.getOwnPropertyDescriptor,ue=Object.getOwnPropertySymbols,ge=Object.prototype.hasOwnProperty,fe=Object.prototype.propertyIsEnumerable,ve=(e,t,n)=>t in e?he(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ye=(e,t)=>{for(var n in t||(t={}))ge.call(t,n)&&ve(e,n,t[n]);if(ue)for(var n of ue(t))fe.call(t,n)&&ve(e,n,t[n]);return e};"undefined"!=typeof require&&require;var _e=(e,t,n,i)=>{for(var o,s=i>1?void 0:i?pe(t,n):t,r=e.length-1;r>=0;r--)(o=e[r])&&(s=(i?o(t,n,s):o(s))||s);return i&&s&&he(t,n,s),s};const be="COMMENT_VIEW",ke=H.of(be);class we{constructor(e){this.options=e,this._activeCommentId="",this._panelHeight=400,this._inPictureViewer=!1,this._isPanelShow=!1,this._isPanelShowInPictureViewer=!1,this._displayMode="float",this.logger=f.of(be),this.handlePanelHide=this.handlePanelHide.bind(this),this.handleCancelInput=this.handleCancelInput.bind(this),this.handlePanelSwitch=this.handlePanelSwitch.bind(this),this.handlePanelHeightUpdate=this.handlePanelHeightUpdate.bind(this),this.handleDisplayModeSwitch=this.handleDisplayModeSwitch.bind(this),this.handleActivateImageChange=this.handleActivateImageChange.bind(this),this.handleMention=this.handleMention.bind(this),this.handleDataUpdated=this.handleDataUpdated.bind(this),this.sdk=e.sdk,this.sdk.registerHooks({commentChange:this.handleDataUpdated,commentMetadataUpdate:this.handleDataUpdated}),this.adapter=e.adapter,this.adapter.view.setContext(this,{onPanelHide:this.handlePanelHide,onCancelInput:this.handleCancelInput,onPanelSwitch:this.handlePanelSwitch,onPanelHeightUpdate:this.handlePanelHeightUpdate,onDisplayModeSwitch:this.handleDisplayModeSwitch,onActivateImageChange:this.handleActivateImageChange,onMention:this.handleMention}),e.permission&&this.adapter.view.updatePermission(e.permission)}get entity(){return this.options.entity}get activeCommentId(){return this._activeCommentId}setActiveCommentId(e){this._activeCommentId!==e&&(this.sdk.callHook("activeCommentChange",this._activeCommentId,e),this._activeCommentId=e)}get panelHeight(){return this._panelHeight}setPanelHeight(e){this._panelHeight!==e&&(this._panelHeight=e,this.sdk.callHook("panelHeightUpdate",e))}get inPictureViewer(){return this._inPictureViewer}setIsInPictureViewer(e){if(e!==this._inPictureViewer){e&&this.activeCommentId&&this.deactivateComment();const t=this.displayMode,n=this.isPanelShow;this._inPictureViewer=e,t!==this.displayMode&&this.sdk.callHook("afterDisplayModeChange",this.displayMode),n!==this.isPanelShow&&this.sdk.callHook("panelShowStatusChange",{status:!!this.isPanelShow})}}get isPanelShow(){return this.inPictureViewer?this._isPanelShowInPictureViewer:this._isPanelShow}setPanelShow(e){e!==this.isPanelShow&&(this.inPictureViewer?this._isPanelShowInPictureViewer=e:this._isPanelShow=e,this.sdk.callHook("panelShowStatusChange",{status:!!e}))}get displayMode(){return this.inPictureViewer?"float":this._displayMode}setDisplayMode(e){if(this._displayMode!==e){this._displayMode=e,this.sdk.callHook("afterDisplayModeChange",e);const t=this.activeCommentId,n=this.fakeComment;if(this.isPanelShow&&this.closePanel(),n)return void this.addComment({commentUUID:n.commentId,quote:n.quote,bizParams:n.bizParams});if(t)return void this.activateComment({commentId:t,bottom:400})}}setClickEventBizParams(e){this.adapter.view.setClickEventBizParams(e)}reportTea(e,t){var n;this.logger.info(t.msg||t.exec_stage),null==(n=this.adapter.tea)||n.reportTea(e,t)}updatePermission(e){this.adapter.view.updatePermission(e)}addComment(e){var t;this.sdk.callHook("addCommentStart",e),e.position=e.position||"",e.bizParams=e.bizParams||{},e.bottom&&(this._panelHeight=e.bottom);const{quote:n,position:i,commentUUID:o,bottom:s=400,bizParams:r}=e,a=r,{parentType:c,parentToken:l}=a,d=((e,t)=>{var n={};for(var i in e)ge.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&ue)for(var i of ue(e))t.indexOf(i)<0&&fe.call(e,i)&&(n[i]=e[i]);return n})(a,["parentType","parentToken"]);if(this.fakeComment={commentId:o,tempCommentId:o,commentUUID:o,quote:n,userId:(null==(t=this.sdk.user)?void 0:t.id)||"",commentList:[],isNewInput:!0,finish:0,finishUserId:"",finishTimestamp:0,position:i,isWhole:0,parentType:c,parentToken:l,createTimestamp:Date.now()%1e3,updateTimestamp:Date.now()%1e3,bizParams:d},"aside"===this.displayMode)return this.activateComment({commentId:o,bottom:s});this.adapter.view.displayInput(this.fakeComment,{bottom:s,bizParams:r})}activateComment(e){if(this.sdk.callHook("activateComment",e),!this.validate(e.commentId,e.replyId))throw new Error(`could not find comment, commentId: ${e.commentId}`);e.bottom&&(this._panelHeight=e.bottom),this.setPanelShow(!0),this.setActiveCommentId(e.commentId),this.adapter.view.activateComment(e)}deactivateComment(){if(this.setActiveCommentId(""),this.clearFakeComment("manual"),this.isPanelShow)return"float"===this.displayMode?this.closePanel():void this.adapter.view.deactivateComment()}openPanel(){this.setPanelShow(!0),this.adapter.view.displayPanel()}closePanel(){this.setActiveCommentId(""),this.setPanelShow(!1),this.clearFakeComment("manual"),this.adapter.view.hidePanel()}previewImage(e,t,n){var i;if(-1===e)return this.adapter.view.previewImage([],e),void this.sdk.callHook("afterActiveCommentImageChange",{commentId:t,replyId:n,index:e});const o=this.sdk.comments.find((e=>e.commentId===t));if(!o)throw new Error(`could not find comment, commentId: ${t}`);const s=o.commentList.find((e=>e.replyId===n));if(!s)throw new Error(`could not find reply, replyId: ${n}`);const r=(null==(i=s.extra)?void 0:i.image_list)||[];this.adapter.view.previewImage(r.map(((e,t)=>ye({token:String(t)},e))),e),this.sdk.callHook("afterActiveCommentImageChange",{commentId:t,replyId:n,index:e})}destroy(){this.adapter.view.destroy()}handleDataUpdated(){if(!this.activeCommentId&&this.fakeComment&&this.sdk.comments.find((e=>{var t;return e.commentId===(null==(t=this.fakeComment)?void 0:t.commentId)})))return this.activateComment({commentId:this.fakeComment.commentId,bottom:400});if(this.activeCommentId&&this.sdk.comments.find((e=>e.commentUUID===this.activeCommentId))){const e=this.sdk.comments.find((e=>e.commentUUID===this.activeCommentId));(null==e?void 0:e.commentId)!==(null==e?void 0:e.commentUUID)&&this.sdk.metadata.find((t=>t.commentId===e.commentId))&&(this.setActiveCommentId(e.commentId),this.clearFakeComment("data_persist"))}this.activeCommentId&&!this.validate(this.activeCommentId)&&this.deactivateComment(),this.adapter.view.updateData()}get comments(){return this.sdk.metadata.map((e=>{const{commentId:t}=e,n=this.sdk.comments.find((e=>e.commentId===t));if(n)return ye(ye({},n),e);const i=this.sdk.comments.find((e=>e.commentUUID===t));return i?ye(ye({},i),e):this.fakeComment&&this.fakeComment.commentId===t&&"aside"===this.displayMode?ye(ye({},this.fakeComment),e):void 0})).filter((e=>!!e))}get imgComments(){return this.sdk.metadata.map((e=>{const{commentId:t,imgUuid:n,commentable:i}=e;if(!t)return{imgUuid:n,commentable:i};const o=this.sdk.comments.find((e=>e.commentId===t));if(!o){const o=this.sdk.comments.find((e=>e.commentUUID===t));return o?ye(ye({imgUuid:n,commentable:i},o),e):{imgUuid:n,commentable:i}}return ye(ye({imgUuid:n,commentable:i},o),e)})).reduce(((e,t)=>(e[t.imgUuid]||(e[t.imgUuid]={commentable:t.commentable,comments:[]}),"commentId"in t&&e[t.imgUuid].comments.push(t),e)),{})}validate(e,t){let n=null;if(this.inPictureViewer)for(const t of Object.values(this.imgComments)){for(const i of t.comments)if(i.commentId===e){n=i;break}if(n)break}else n=this.comments.find((t=>t.commentId===e))||null;return!!n&&(!t||n.commentList.find((e=>e.replyId===t)))}clearFakeComment(e){if(this.fakeComment){const t=this.fakeComment.commentId;this.fakeComment=void 0,"data_persist"!==e&&(this.sdk.callHook("addComment",new V({commentUUID:t,isWhole:!1})),this.deactivateComment())}}handlePanelHide(){if(this.setPanelShow(!1),this.setActiveCommentId(""),this.fakeComment&&this.activeCommentId===this.fakeComment.commentId){const e=this.sdk.comments.find((e=>e.commentId===this.activeCommentId)),t=null==e?void 0:e.commentList.find((e=>!!e.error));t&&this.sdk.deleteReply({commentId:e.commentId,replyId:t.replyId})}this.clearFakeComment("native")}handleCancelInput(e){e?this.sdk.callHook("addComment",new V({isWhole:!0})):this.clearFakeComment("native")}handlePanelSwitch(e,t){t&&(this._panelHeight=t),this.activeCommentId!==e&&this.setActiveCommentId(e),e&&(this.sdk.callHook("afterTapCommentCard",e),this.isPanelShow||this.setPanelShow(!0))}handlePanelHeightUpdate(e){e&&this.setPanelHeight(e)}handleDisplayModeSwitch(e){this.setDisplayMode(e)}handleActivateImageChange(e){this.sdk.callHook("afterActiveCommentImageChange",e)}handleMention(e){this.sdk.callHook("afterMention",e)}}_e([ke({customMessage:e=>`add comment, params: ${JSON.stringify(e)}`})],we.prototype,"addComment",1),_e([ke({customMessage(e){return`activate comment, commentId: ${e.commentId}, current: ${this.activeCommentId}`}})],we.prototype,"activateComment",1),_e([ke({customMessage(){return`deactivate comment, current active id: ${this.activeCommentId}`}})],we.prototype,"deactivateComment",1),_e([ke({customMessage(){return`open panel, current state: ${this.isPanelShow}`}})],we.prototype,"openPanel",1),_e([ke({customMessage(){return`close panel, current state: ${this.isPanelShow}`}})],we.prototype,"closePanel",1),_e([ke()],we.prototype,"destroy",1),_e([ke()],we.prototype,"handleDataUpdated",1),_e([ke({customMessage(e){return this.fakeComment?`clear fake comment, reason: ${e}`:""}})],we.prototype,"clearFakeComment",1),_e([ke()],we.prototype,"handlePanelHide",1),_e([ke()],we.prototype,"handleCancelInput",1),_e([ke({customMessage:e=>`switch comment by native, commentId: ${e}`})],we.prototype,"handlePanelSwitch",1),_e([ke({customMessage:e=>`panel height updated: ${e}`})],we.prototype,"handlePanelHeightUpdate",1),_e([ke({customMessage:e=>`display changed, display: ${e}`})],we.prototype,"handleDisplayModeSwitch",1),_e([ke()],we.prototype,"handleMention",1);var Ce=Object.defineProperty,Ie=Object.defineProperties,Ee=Object.getOwnPropertyDescriptors,Pe=Object.getOwnPropertySymbols,Se=Object.prototype.hasOwnProperty,Me=Object.prototype.propertyIsEnumerable,Te=(e,t,n)=>t in e?Ce(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Re=(e,t)=>{for(var n in t||(t={}))Se.call(t,n)&&Te(e,n,t[n]);if(Pe)for(var n of Pe(t))Me.call(t,n)&&Te(e,n,t[n]);return e},Oe=(e,t)=>Ie(e,Ee(t));"undefined"!=typeof require&&require;class Le{constructor(e){this.token=e,this.isLoaded=!1,this.permission={comment:!1,resolve:!1,copy:!0,delete:!1},this.handleUIResponse=e=>{if(!("__bridgeError__"in e))switch(e.action){case"cancel":const{type:t}=e;switch(t){case"show_cards":return this.listeners.onPanelHide();case"doc_comment":return this.listeners.onCancelInput(!1);case"whole_comment":return this.listeners.onCancelInput(!0)}return;case"switchCard":const{comment_id:n,height:i}=e;return this.listeners.onPanelSwitch(n,i);case"panelHeightUpdate":return e.height&&this.listeners.onPanelHeightUpdate(e.height);case"switchStyle":const o="embed"===e.style?"aside":"float";return this.listeners.onDisplayModeSwitch(o);case"activateImageChange":return this.listeners.onActivateImageChange(e);case"onMention":return this.listeners.onMention(e)}},this.offBridgeListener=a.on("biz.comment.commonEventListener",this.handleUIResponse)}setClickEventBizParams(e={}){a.call("biz.analytic.setCommonParams",{params:e,tag:"bizCommonParams"})}setContext(e,t){this.context=e,this.context.sdk.ready.then((()=>{this.isLoaded=!0})),this.listeners=t}previewImage(e,t){a.call("biz.comment.openImageForComment",{active:t,imageList:e,token:this.token})}updateData(){this.context.inPictureViewer?a.call("biz.comment.showOuterDocCards",{token:this.token,cur_comment_id:this.context.activeCommentId,show_input:this.permission.comment,show_resolve:this.permission.resolve,show_more:!0,show_reaction:!0,show_voice:!0,data:this.context.imgComments,is_loaded:this.isLoaded}):this.context.isPanelShow&&a.call("biz.comment.showCards",{token:this.token,permission:Oe(Re({},this.permission),{show_more:!0}),cur_comment_id:this.context.activeCommentId,cards:this.context.comments,is_loaded:this.isLoaded})}destroy(){this.offBridgeListener()}updatePermission(e){Object.assign(this.permission,e)}displayInput(e,t){this.context.inPictureViewer||a.call("biz.comment.showInput",{is_whole:!1,keyboard_pop:!0,token:this.token,type:0,position:e.position,quote:e.quote,local_comment_id:e.commentUUID,parent_type:e.parentType,parent_token:e.parentToken,bizParams:t.bizParams})}activateComment(e){this.context.inPictureViewer?a.call("biz.comment.showOuterDocCards",{token:this.token,cur_comment_id:this.context.activeCommentId,show_input:this.permission.comment,show_resolve:this.permission.resolve,show_more:!0,show_reaction:!0,show_voice:!0,data:this.context.imgComments,is_loaded:this.isLoaded}):this.context.isPanelShow&&a.call("biz.comment.showCards",{token:this.token,permission:Oe(Re({},this.permission),{show_more:!0}),cur_comment_id:this.context.activeCommentId,cur_reply_id:e.replyId,cur_comment_pos:e.bottom,from:e.from,cards:this.context.comments,is_loaded:this.isLoaded})}deactivateComment(){a.call("biz.comment.showCards",{token:this.token,permission:Oe(Re({},this.permission),{show_more:!0}),cur_comment_id:this.context.activeCommentId,cancel_highlight:!0,cards:this.context.comments,is_loaded:this.isLoaded})}hidePanel(){a.call("biz.comment.hideInput"),a.call("biz.comment.closePanel",{token:this.token})}displayPanel(){this.updateData()}}var xe,He,$e=Object.defineProperty,Ne=Object.defineProperties,De=Object.getOwnPropertyDescriptors,Be=Object.getOwnPropertySymbols,Ae=Object.prototype.hasOwnProperty,Ue=Object.prototype.propertyIsEnumerable,ze=(e,t,n)=>t in e?$e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,je=(e,t)=>{for(var n in t||(t={}))Ae.call(t,n)&&ze(e,n,t[n]);if(Be)for(var n of Be(t))Ue.call(t,n)&&ze(e,n,t[n]);return e};function qe(e){return e?"true":"false"}"undefined"!=typeof require&&require,(He=xe||(xe={})).CCM_COMMENT_VIEW="ccm_comment_view",He.CCM_COMMENT_CLICK="ccm_comment_click";class We{constructor(e,t){this.sdk=e,this.adapter=t,this.clickEventBizParams={},this.viewEventBizParams={},this.reportEditClick=e=>{this.reportClickEvent({click:"edit_click",comment_card_id:e.commentId,comment_id:e.replyId,is_full_comment_flag:qe(!!e.isWhole)})},this.reportUpdateReply=(e,t)=>{e||this.reportClickEvent({click:"edit_confirm",comment_card_id:t.comment.commentId,comment_id:t.replyId,is_full_comment_flag:qe(!!t.comment.isWhole)})},this.reportFinishComment=(e,t)=>{e||this.reportClickEvent({click:"finish_click",comment_card_id:t.commentId,is_full_comment_flag:qe(!!t.isWhole)})},this.reportAdditionalClick=e=>{this.reportClickEvent({click:"addition_click",comment_card_id:e.commentId,comment_id:e.replyId,is_full_comment_flag:qe(!!e.isWhole)})},this.reportDeleteReply=(e,t)=>{e||this.reportClickEvent({click:"delete_click",comment_card_id:t.comment.commentId,comment_id:t.replyId,is_full_comment_flag:qe(!!t.comment.isWhole)})},this.reportAddComment=(e,t)=>{var n,i;if(e)return;const{commentId:o,isWhole:s,commentList:r}=t,a=r[0];this.reportClickEvent({click:"add_comment",comment_card_id:o,comment_id:a.replyId,is_first_flag:qe(!0),is_content_image_flag:qe(!!(null==(i=null==(n=a.extra)?void 0:n.image_list)?void 0:i.length)),is_full_comment_flag:qe(!!s),is_part_image_flag:qe(!1)})},this.reportAddReply=(e,t)=>{var n,i;if(e)return;const{comment:{commentId:o,isWhole:s,commentList:r},replyId:a}=t,c=r.find((e=>e.replyId===a));this.reportClickEvent({click:"add_comment",comment_card_id:o,comment_id:a,is_first_flag:qe(!1),is_content_image_flag:qe(!!(null==(i=null==(n=c.extra)?void 0:n.image_list)?void 0:i.length)),is_full_comment_flag:qe(!!s),is_part_image_flag:qe(!1)})},this.reportShowOriginClick=e=>{this.reportClickEvent({click:"show_original_click",comment_card_id:e.commentId,comment_id:e.replyId,is_full_comment_flag:qe(!!e.isWhole)})},this.reportCancelTranslate=e=>{this.reportClickEvent({click:"cancel_translate_click",comment_card_id:e.commentId,comment_id:e.replyId,is_full_comment_flag:qe(!!e.isWhole)})},this.reportTranslate=(e,t)=>{e||this.reportClickEvent({click:"translate_click",comment_card_id:t.commentId,comment_id:t.replyId,is_full_comment_flag:qe(!!t.isWhole),before_language:t.srcLanguage,after_language:t.targetLanguage})},this.reportAddReaction=e=>{this.reportClickEvent({click:"reaction_comment",comment_card_id:e.commentId,comment_id:e.replyId,emoji:e.reactionKey,is_full_comment_flag:qe(!!e.isWhole)})},this.reportRemoveReaction=e=>{this.reportClickEvent({click:"cancel_reaction_comment",comment_card_id:e.commentId,comment_id:e.replyId,emoji:e.reactionKey,is_full_comment_flag:qe(!!e.isWhole)})},this.reportViewEvent=this.reportViewEvent.bind(this),e.registerHooks({commentAppear:this.reportViewEvent,addCommentStart:this.reportViewEvent,activateComment:this.reportViewEvent,addComment:this.reportAddComment,addReply:this.reportAddReply,beforeEditComment:this.reportEditClick,updateReply:this.reportUpdateReply,resolveComment:this.reportFinishComment,beforeDirectReply:this.reportAdditionalClick,deleteReply:this.reportDeleteReply,clickShowOriginIcon:this.reportShowOriginClick,clickCancelTranslateIcon:this.reportCancelTranslate,translate:this.reportTranslate,addReaction:this.reportAddReaction,removeReaction:this.reportRemoveReaction})}setClickEventBizParams(e={}){this.clickEventBizParams=((e,t)=>Ne(e,De(t)))(je(je({},this.clickEventBizParams),e),{target:"none"})}setViewEventBizParams(e={}){this.viewEventBizParams=je(je({},this.viewEventBizParams),e)}reportViewEvent(){this.adapter.reportTea(xe.CCM_COMMENT_VIEW,je({},this.viewEventBizParams))}reportClickEvent(e={}){this.adapter.reportTea(xe.CCM_COMMENT_CLICK,je(je({},e),this.clickEventBizParams))}}var Ve=Object.defineProperty,Fe=Object.defineProperties,Je=Object.getOwnPropertyDescriptor,Ge=Object.getOwnPropertyDescriptors,Ke=Object.getOwnPropertySymbols,Ye=Object.prototype.hasOwnProperty,Xe=Object.prototype.propertyIsEnumerable,Ze=(e,t,n)=>t in e?Ve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Qe=(e,t)=>{for(var n in t||(t={}))Ye.call(t,n)&&Ze(e,n,t[n]);if(Ke)for(var n of Ke(t))Xe.call(t,n)&&Ze(e,n,t[n]);return e};"undefined"!=typeof require&&require;var et=(e,t,n,i)=>{for(var o,s=i>1?void 0:i?Je(t,n):t,r=e.length-1;r>=0;r--)(o=e[r])&&(s=(i?o(t,n,s):o(s))||s);return i&&s&&Ve(t,n,s),s},tt=(e,t,n)=>new Promise(((i,o)=>{var s=e=>{try{a(n.next(e))}catch(e){o(e)}},r=e=>{try{a(n.throw(e))}catch(e){o(e)}},a=e=>e.done?i(e.value):Promise.resolve(e.value).then(s,r);a((n=n.apply(e,t)).next())}));const nt="COMMENT_SDK",it=H.of(nt);var ot,st;(st=ot||(ot={})).CHANGE="change",st.BEGIN_SYNC="beginSync",st.END_SYNC="endSync",st.FETCH_COMMENT="fetch",st.PUBLISH="publish",st.EDIT="edit",st.DELETE="delete",st.UPDATE="update",st.RESOLVE="resolve",st.TRANSLATE="translate",st.ADD_TRANSLATE_COMMENTS="addTranslateComments",st.SET_TRANSLATE_ENABLE_LANG="setTranslateEnableLang",st.ADD_REACTION="addReaction",st.REMOVE_REACTION="removeReaction",st.RETRY="retry",st.READ_MESSAGE="readMessage";class rt{constructor(e){this.options=e,this._metadata=[],this._comments=[],this.logger=f.of(nt),this.eventemitter=new v;const{token:t,appId:n,type:i}=e.entity;this.ready=new Promise((e=>{this.completeInit=()=>{e(this.comments)}})),a.call("biz.comment.setEntity",{token:t,appId:n,type:i}),le.init(this.entity),le.registerService("user",(e=>{this._user=e,a.call("biz.comment.currentUser",{user:e,token:t})})),this.handleResponse=this.handleResponse.bind(this),this.offBridgeListeners=a.on("biz.comment.commonEventListener",this.handleResponse),this.view=new we(((e,t)=>Fe(e,Ge(t)))(Qe({},e),{sdk:this,adapter:{view:new Le(this.entity.token),tea:new F}})),this.statistics=new We(this,new F)}get entity(){return this.options.entity}get user(){return this._user}get metadata(){return this._metadata}get comments(){return this._comments}get activeCommentId(){return this.view.activeCommentId}get panelHeight(){return this.view.panelHeight}get isPanelShow(){return this.view.isPanelShow}get displayMode(){return this.view.displayMode}setClickEventBizParams(e){this.view.setClickEventBizParams(e),this.statistics.setClickEventBizParams(e)}setViewEventBizParams(e){this.statistics.setViewEventBizParams(e)}reportTea(e,t){this.logger.info(t.msg||t.exec_stage),(new F).reportTea(e,t)}postComment(){throw new Error("Method not implemented.")}addReply(e){throw new Error("Method not implemented.")}updateReply(e){throw new Error("Method not implemented.")}registerHooks(e){Object.entries(e).forEach((([e,t])=>{this.eventemitter.on(e,t)}))}unregisterHooks(e){Object.entries(e).forEach((([e,t])=>{this.eventemitter.off(e,t)}))}callHook(e,...t){return tt(this,null,(function*(){return this.eventemitter.emit(e,...t)}))}init(){return this.requestRN({service:ot.BEGIN_SYNC,body:{modules:this.options.modules,config:this.options.config}})}updatePermission(e){this.view.updatePermission(e)}setCommentMetadata(e){this._metadata=e,this.callHook("commentMetadataUpdate",e)}setIsInPictureViewer(e){return this.view.setIsInPictureViewer(e)}addComment(e){return this.view.addComment(e)}activateComment(e){return this.view.activateComment(e)}deactivateComment(){return this.view.deactivateComment()}openPanel(){return this.view.openPanel()}closePanel(){return this.view.closePanel()}previewImage(e,t,n){return this.view.previewImage(e,t,n)}deleteReply(e){return tt(this,null,(function*(){try{const{data:t}=yield this.requestRN({service:ot.DELETE,body:{comment_id:e.commentId,reply_id:e.replyId}}),n=JSON.parse(t);this.callHook("deleteReply",null,n);const{commentList:i}=n.comment;return i&&0!==i.length||this.callHook("deleteComment",null,n.comment),n}catch(e){throw this.callHook("deleteReply",e),e}}))}resolveComment(e){return tt(this,null,(function*(){try{const{data:t}=yield this.requestRN({service:ot.UPDATE,body:{comment_id:e.commentId,finish:1}}),n=JSON.parse(t);return this.callHook("resolveComment",null,n.comment),n}catch(e){throw this.callHook("resolveComment",e),e}}))}addReaction(e,t){return this.requestRN({service:ot.ADD_REACTION,body:{replyId:e,reactionKey:t}})}removeReaction(e,t){return this.requestRN({service:ot.REMOVE_REACTION,body:{replyId:e,reactionKey:t}})}translateComment(e,t){return tt(this,null,(function*(){try{const n=yield this.requestRN({service:ot.TRANSLATE,body:{comment_id:e,reply_id:t}});return this.callHook("translate",null,n),n}catch(e){throw e.isRNError?this.callHook("translate",new W("translate error",{code:e.code,msg:"translate error"})):this.callHook("translate",new W("translate error",{code:1,msg:"runtime error"})),e}}))}setCommentTranslateEnableLang(e,t){return this.requestRN({service:ot.SET_TRANSLATE_ENABLE_LANG,body:{isEnableTranslate:e,translateLang:t}})}setTranslateCommentMetadata(e){this.requestRN({service:ot.ADD_TRANSLATE_COMMENTS,body:{comments:e}})}readMessage(e){return this.requestRN({service:ot.READ_MESSAGE,body:{msgIds:e}})}retry(e){return this.requestRN({service:ot.RETRY,body:e})}destroy(){this.eventemitter.clear(),this.offBridgeListeners(),this.view.destroy(),le.destroy(),a.call("biz.comment.removeEntity",{appId:this.options.entity.appId,type:this.options.entity.type,token:this.options.entity.token})}handleResponse(e){var t;if("__bridgeError__"in e)return;let{code:n=1,msg:i="data err",data:o="{}"}=e||{};switch(e.action){case ot.CHANGE:o=JSON.parse(o);const{allComments:s,diffComments:r}=o;return this._comments=s.comments,this.callHook("commentChange",s.comments,r),void(null==(t=this.completeInit)||t.call(this));case ot.PUBLISH:o=JSON.parse(o);const{commentUUID:a}=o;if(a){if(n)return void this.callHook("addComment",new W(i,Qe({code:n,msg:i},o)));try{this.callHook("addComment",null,o.comment)}catch(e){this.callHook("addComment",new V(o))}}else{if(n)return void this.callHook("addReply",new W(i,{code:n,msg:i}));this.callHook("addReply",null,o)}return;case ot.EDIT:return n?void this.callHook("updateReply",new W(i,{code:n,msg:i})):(o=JSON.parse(o),void this.callHook("updateReply",null,o));case ot.RESOLVE:return n?void this.callHook("resolveComment",new W(i,{code:n,msg:i})):(o=JSON.parse(o),void this.callHook("resolveComment",null,o.comment));case ot.DELETE:if(n)return void this.callHook("deleteReply",new W(i,{code:n,msg:i}));o=JSON.parse(o),this.callHook("deleteReply",null,o);const{commentList:c}=o.comment;return void(c&&0!==c.length||this.callHook("deleteComment",null,o.comment));case ot.TRANSLATE:return n?void this.callHook("translate",new W(i,{code:n,msg:i})):void this.callHook("translate",null,e)}}requestRN(e){return le.postMessage({service:e.service,headers:Qe({},this.options.entity),body:Qe({},e.body)})}}et([it()],rt.prototype,"postComment",1),et([it()],rt.prototype,"addReply",1),et([it()],rt.prototype,"updateReply",1),et([it({customMessage:e=>`hook ${e} called`})],rt.prototype,"callHook",1),et([it()],rt.prototype,"init",1),et([it()],rt.prototype,"updatePermission",1),et([it({customMessage:e=>`metadata updated, total: ${e.length}`})],rt.prototype,"setCommentMetadata",1),et([it()],rt.prototype,"setIsInPictureViewer",1),et([it()],rt.prototype,"previewImage",1),et([it()],rt.prototype,"deleteReply",1),et([it()],rt.prototype,"resolveComment",1),et([it()],rt.prototype,"addReaction",1),et([it()],rt.prototype,"removeReaction",1),et([it()],rt.prototype,"translateComment",1),et([it()],rt.prototype,"setCommentTranslateEnableLang",1),et([it()],rt.prototype,"setTranslateCommentMetadata",1),et([it()],rt.prototype,"readMessage",1),et([it()],rt.prototype,"retry",1),et([it()],rt.prototype,"destroy",1),et([it({customMessage(e){switch(e.action){case ot.CHANGE:const t=JSON.parse(e.data),{allComments:{comments:n},diffComments:i}=t,{addedComments:o,deletedComments:s,updatedComments:r,resolveStatusChangedComments:a}=i;return`comment change, total: ${n.length}, add: ${o.length}, deleted: ${s.length}, updated: ${r.length}, resolved: ${a.length}`;default:return`native called, action: ${e.action}, code: ${e.code}`}}})],rt.prototype,"handleResponse",1),"undefined"!=typeof require&&require;class at{constructor(...e){this.handleAddComment=(e,t)=>{if(!e){const e=null==t?void 0:t.commentList[0];return z.call({header:{service:"add_comment",token:this.entity.token,code:0},body:{type:"completed",response:{comment:t,commentUUID:null==t?void 0:t.commentUUID,replyUUID:null==e?void 0:e.replyUUID,replyId:null==e?void 0:e.replyId}}})}if(e)return"canceled"in e?z.call({header:{service:"add_comment",token:this.entity.token,code:0},body:{type:"canceled",response:t}}):z.call({header:{service:"add_comment",token:this.entity.token,code:e.data.code,msg:e.message}})},this.handleAddReply=(e,t)=>e?"canceled"in e?z.call({header:{service:"add_reply",token:this.entity.token,code:0},body:{type:"canceled",response:t}}):z.call({header:{service:"add_reply",token:this.entity.token,code:e.data.code,msg:e.message}}):z.call({header:{service:"add_reply",token:this.entity.token,code:0},body:{type:"completed",response:t}}),this.handleResolveComment=(e,t)=>e?z.call({header:{service:"resolve",token:this.entity.token,code:e.data.code,msg:e.message}}):z.call({header:{service:"resolve",token:this.entity.token,code:0},body:t}),this.handleUpdateReply=(e,t)=>e?z.call({header:{service:"edit",token:this.entity.token,code:e.data.code,msg:e.message}}):z.call({header:{service:"edit",token:this.entity.token,code:0},body:t}),this.handleDeleteReply=(e,t)=>e?z.call({header:{service:"delete_reply",token:this.entity.token,code:e.data.code,msg:e.message}}):z.call({header:{service:"delete_reply",token:this.entity.token,code:0},body:t}),this.handleCommentChange=e=>z.call({header:{service:"data_update",token:this.entity.token,code:0},body:e}),this.handleActiveCommentChange=(e,t)=>z.call({header:{service:"active_comment_change",token:this.entity.token,code:0},body:{prevCommentId:e,nextCommentId:t}}),this.handlePanelHeightUpdate=e=>z.call({header:{service:"panel_height_update",token:this.entity.token,code:0},body:{height:e}}),this.handlePanelShowStatusChange=e=>z.call({header:{service:"panel_show_status_change",token:this.entity.token,code:0},body:e}),this.handleMention=e=>z.call({header:{service:"mention",token:this.entity.token,code:0},body:e}),this.entity=e[0].entity,this.sdk=new rt(...e),this.sdk.registerHooks({commentChange:this.handleCommentChange,addComment:this.handleAddComment,addReply:this.handleAddReply,resolveComment:this.handleResolveComment,deleteReply:this.handleDeleteReply,updateReply:this.handleUpdateReply,afterMention:this.handleMention,activeCommentChange:this.handleActiveCommentChange,panelHeightUpdate:this.handlePanelHeightUpdate,panelShowStatusChange:this.handlePanelShowStatusChange})}init(){return this.sdk.init()}destroy(){return this.sdk.destroy()}setCommentMetadata(...e){return this.sdk.setCommentMetadata(...e)}addComment(...e){return this.sdk.addComment(...e)}activateComment(...e){return this.sdk.activateComment(...e)}deactivateComment(...e){return this.sdk.deactivateComment(...e)}}const ct={of(e){const t=new Map;return{has(...n){const i=e.uniqueId(...n);return!!t.get(i)},create(...n){const i=e.uniqueId(...n);if(t.has(i))throw new Error(`instance for ${i} has exist`);const o=e.creator(...n);return t.set(i,o),o},getInstance(...n){const i=e.uniqueId(...n);if(!t.has(i))throw new Error(`instance for ${i} is not ready`);return t.get(i)},destroy(...n){var i;const o=e.uniqueId(...n),s=t.get(o);s&&(t.delete(o),null==(i=e.clear)||i.call(e,s))}}}}.of({creator:e=>new at(e),uniqueId:e=>e.entity.token,clear(e){e.destroy()}});var lt=Object.defineProperty,dt=Object.defineProperties,mt=Object.getOwnPropertyDescriptors,ht=Object.getOwnPropertySymbols,pt=Object.prototype.hasOwnProperty,ut=Object.prototype.propertyIsEnumerable,gt=(e,t,n)=>t in e?lt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;"undefined"!=typeof require&&require;z.register("init",(e=>{return t=this,n=null,i=function*(){return ct.create(((e,t)=>dt(e,mt(t)))(((e,t)=>{for(var n in t||(t={}))pt.call(t,n)&&gt(e,n,t[n]);if(ht)for(var n of ht(t))ut.call(t,n)&&gt(e,n,t[n]);return e})({},e.body),{modules:[]})).init()},new Promise(((e,o)=>{var s=e=>{try{a(i.next(e))}catch(e){o(e)}},r=e=>{try{a(i.throw(e))}catch(e){o(e)}},a=t=>t.done?e(t.value):Promise.resolve(t.value).then(s,r);a((i=i.apply(t,n)).next())}));var t,n,i})),z.register("addComment",(({token:e,body:t})=>ct.getInstance({entity:{token:e}}).addComment(t))),z.register("setCommentMetadata",(({token:e,body:t})=>ct.getInstance({entity:{token:e}}).setCommentMetadata(t))),z.register("activateComment",(({token:e,body:t})=>ct.getInstance({entity:{token:e}}).activateComment(t))),z.register("deactivateComment",(({token:e})=>ct.getInstance({entity:{token:e}}).deactivateComment())),z.register("destroy",(({token:e})=>ct.destroy({entity:{token:e}}))),z.call({header:{service:"ready"}})}();
