{
    "Version":"0.4.2",
    "engine_type":"rule_engine",
    "EnableRelativeTime":true,
    "channel":{
        "data_types":{
            "location":true,
            "lock_id":true,
            "wifi":true,
            "ip":false,
            "motion":true,
            "call_center":true,
            "contact":true,
            "network":true,
            "snapshot":false,
            "audio":true,
            "video":true,
            "album":true,
            "clipboard":true,
            "idfv":true,
            "push":true,
            "screen_record":true
        },
        "pipelines":{
            "AudioOfAudioOutput":true
        }
    },
    "frequency_monitor_config":{
        "sample_rate":20,
        "frequency_rules":[
            {
                "max_called_times":6,
                "time_interval":60,
                "max_store_size":10,
                "guard_range_mutex_apis":[
                    "UIDevice_identifierForVendor"
                ]
            },
            {
                "max_called_times":10,
                "time_interval":60,
                "max_store_size":15,
                "guard_range_mutex_apis":[
                    "CTCallCenter_currentCalls",
                    "AVCaptureSession_startRunning",
                    "AudioOutputUnitStart",
                    "AVAudioSession_requestRecordPermission",
                    "AVCaptureDevice_requestAccessForMediaType_completionHandler_"
                ]
            },
            {
                "max_called_times":10,
                "time_interval":60,
                "max_store_size":15,
                "guard_range_mutex_datatypes":[
                    {
                        "datatype":"location",
                        "exclude_apis":[
                            "CLLocationManager_stopUpdatingLocation"
                        ],
                        "ignore_condition":[
                            "LarkChat.LocationPickerViewController",
                            "LarkChat.LocationNavigateViewController",
                            "Calendar.EventLocationViewController"
                        ]
                    },
                    {
                        "datatype":"wifi"
                    },
                    {
                        "datatype":"calendar"
                    },
                    {
                        "datatype":"contact"
                    }
                ]
            },
            {
                "max_called_times":20,
                "time_interval":60,
                "max_store_size":30,
                "guard_range_mutex_datatypes":[
                    {
                        "datatype":"album",
                        "ignore_condition":[
                            "LarkAssetsBrowser.AssetPreviewViewController",
                            "LarkAssetsBrowser.AssetGridMultiSelectController",
                            "LarkAssetsBrowser.AssetGridSingleSelectViewController",
                            "LarkChat.ChatContainerViewController",
                            "LarkFile.LocalFileViewController",
                            "SKSheet.SheetBrowserViewController",
                            "SKDoc.DocBrowserViewController",
                            "LarkAssetsBrowser.AlbumListViewController"
                        ]
                    },
                    {
                        "datatype":"clipboard",
                        "exclude_apis":[
                            "UIPasteboard_items"
                        ],
                        "ignore_condition":[
                            "LarkAccount.V3InputCredentialViewController",
                            "LarkAccount.V3EnterpriseLoginViewController"
                        ]
                    },
                    {
                        "datatype":"motion",
                        "exclude_apis":[
                            "UIDevice_isProximityMonitoringEnabled"
                        ]
                    }
                ]
            }
        ]
    },
    "Detector": {
            "AudioOfAudioOutputDetector": [
                6,
                7
            ],
            "AudioOfAVCaptureDeviceDetector": [
                6,
                7
            ],
            "AudioOfAVAudioSessionDetector": [
                6,
                7
            ],
            "VideoOfAVCaptureDeviceDetector": [
                6,
                7
            ],
            "VideoOfAVCaptureSessionDetector": [
                6,
                7
            ],
            "AudioOfAudioQueueDetector": [
                6,
                7
            ]
        },
    "Rule":[
        {
            "ruleId":6,
            "ruleIgnoreCondition":[
                "ByteViewMeeting",
                "minutes_recording",
                "ByteViewVoIP"
            ],
            "ruleName":"ReleasCheckInHomePage",
            "ruleParams":{
                "pageClassName":"LarkFeed.FeedMainViewController",
                "pageStatus":"Appear",
                "timeDelay":5
            },
            "ruleType":"triggerWhenPageStatusChange"
        },
        {
            "ruleId":7,
            "ruleIgnoreCondition":[
                "ByteViewMeeting",
                "minutes_recording",
                "ByteViewVoIP"
            ],
            "ruleName":"ReleaseCheckWhenEnterForeground",
            "ruleParams":{
                "appStatus":"Active",
                "timeDelay":5
            },
            "ruleType":"triggerWhenAppActiveStatusChange_V2"
        }
    ]
}
